# 데이터베이스 이론

## 1. Database의 개념
#### 1) 용어 정리
- Data : 의미를 가지면서 기록될 수 있는 알려진 사실
- 작은 세계(mini world) : 데이터베이스 구축의 대상이 되는 실세계의 일부분

- DB : 특정 소프트웨어나 프로그램에 종속되지 않고 독립된 정보(관련있는 데이터) 저장소
- DBMS : DB 생성과 관리를 담당하는 소프트웨어 패키지  
		흔히 말하는 데이터베이스가 DBMS를 의미  
		DB는 그냥 정보를 넣고 빼고 하는 창고의 개념이고  
		DBMS는 그 원하는 정보를 찾아서 빼는 자판기같은 역할  
- RDBMS : 관계형 데이터베이스 관리 시스템(Relational Database Management System)

- SQL : DBMS에서 사용자가 원하는 기능(삽입 삭제 수정 등)을 하기 위해 사용하는 언어  
		즉 DBMS라는 자판기의 버튼같은 느낌  
		\[에스큐엘\]이라고 발음하기도 하고 편하게 Sequel\[시퀄\]이라고 발음하기도 함  

- 데이터베이스 관리자(database administrator, DBA) : 데이터베이스 시스템의 관리를 책임진 사람
- 데이터베이스 설계자(database designer) : DB설계를 책임진 사람
- 최종 사용자(end users) : db에 질의, 갱신, 보고서작성등을 하는 사람
- 시스템분석가/응용프로그래머 : 초보사용자를 위해 잘 정의된 응용프로그램을 설계하고 구현하는 사람
- 데이터베이스 응용프로그램이 하는 것  
	- 질의 : 정보 검색  
	- 갱신 : 최신의 정보로 유지

- DBS : 데이터베이스 시스템(DB, 하드웨어, 소프트웨어, 유저 모두를 포함해서 칭하는 용어)

#### 2) 데이터베이스의 특징
- 데이터의 중앙화
	- 하나의 데이터저장소만 유지하면서 여러 사용자에 의해 공유하고 사용
	- 여러 부서에서 각각의 데이터를 보관하고 처리하는 노력을 할 필요 없음

- 자기기술성(self describing)
	- 카탈로그에 메타데이터(데이터베이스에 대한 정보)가 저장
	- 이를 이용하여 하나의 DBMS가 다수의 데이터베이스 관리

- 프로그램과 데이터의 분리 및 데이터 추상화
	- DB내의 저장구조가 변경되어도 응용프로그램은 영향을 받지 않음(독립성)

- 데이터에 대한 다양한 뷰 제공
	- 저장 구조의 자세한 내용은 사용자에게 은닉하고, 사용자가 관심있어하는 데이터베이스의 일부분을 뷰로 제공

- 데이터 공유와 여러 사용자 트랜잭션 처리
	- 동시성을 제어하며 온라인트랜잭션 처리(고립성, 원자성)

#### 3) 데이터베이스의 사용효과
- 표준화된 데이터 관리(효율성 증대)
- 데이터 구조 변경에 융통성 부여(독립성으로 인해 구조변경해도 사용자측에선 영향없음)
- 응용프로그램 개발시간 단축(대부분을 DBMS가 처리해주니까)
- 항상 최신정보를 제공(한사람이 갱신하면 나머지사람들도 즉시 변경된 정보 접근 가능)
- 규모의 경제성(부서마다 관리하는것보다 통합DB로 관리하니 전체적으로 저비용)

#### 4) 3 스키마 구조
외부단계 / 개념단계 / 내부단계의 3단계로 구성

- 외부단계
	- 외부 스키마로 사용자의 데이터타입(뷰)를 제공
	- 프로그램이 사용하는 모든 데이터타입을 제공해주며, 특정 사용자가 사용하는 데이터를 제외한 나머지는 은폐

- 개념단계
	- 모든 사용자를 위한 데이터베이스 구조
	- 어떤 항목들로 구성되는지 관심을 가져서 엔터티, 데이터타입, 릴레이션쉽, 사용자연산, 제약조건에 중점
	- 물리적 저장구조에 대해서는 은폐

- 내부단계
	- 물리적 모델을 사용하여 데이터가 어떤 편성으로 저장되는지 관심
	- 데이터 저장구조의 세부사항과 접근경로를 기술

실제 데이터는 물리적단계에만 존재하지만, 나머지 단계에서 변환을 해서 사용자가 볼 수 있게 하는 것

#### 5) DBMS의 기능
- 정의, 생성, 조작
	- 정의 : 데이터타입, 데이터구조, 제약조건들에 대한 정의
	- 생성 : 특정의 데이터를 저장장치에 효과적으로 저장
	- 조작 : 질의, 갱신, 데이터에 대한 보고서작성
- 데이터 중복의 최소화 및 통제된 데이터 중복성 제어(데이터 일치성 보장 및 메모리낭비 방지)
- 동시성 제어(다 사용자간의 데이터의 공유 및 동시접근 보장)
- 보안기능(권한이 없는 사용자의 접근 통제)
- 다양한 사용자 인터페이스 제공(복잡한 릴레이션쉽을 쉽게 표현)
- 데이터베이스의 무결성 보장(백업과 복구기능 제공)


  ## 2. 관계형 Database의 개념
- 데이터베이스를 릴레이션들의 집합으로 표현
- 데이터가 표형태의 릴레이션(테이블)에 저장
- 관계형 데이터베이스가 아닌 데이터베이스들도 있지만 이 DB들은 처리 방식이 다 제각각이라 그냥 noSQL 혹은 non-RDB라고 부름  
- 관계형 데이터베이스는 보통 작은 프로그램이나 개인용은 mySQL을 사용, 큰 규모의 기업체수준은 Oracle을 사용

#### 1) 릴레이션
- 값들의 테이블
- 릴레이션 스키마와 행들의 집합으로 이루어짐
- 릴레이션 스키마란 릴레이션의 이름과, 애트리뷰트들의 이름
>[!note]
> 행 : row / 열 : column / 데이터 행 : 튜플 /  테이블 : 릴레이션

#### 2) 릴레이션의 특성
- 튜플들의 집합(릴레이션)에서 튜플들의 순서는 중요하지 않음(저장은 특정 순서대로 되긴 하지만 무의미)
- 한 튜플 내의 값들은 애트리뷰트의 순서에 의해 결정, 애트리뷰트와 대응하는 값을 알 수 있으면 순서는 중요하지 않음
- 하지만 한 튜플 내의 값들이 애트리뷰트와 대응관계를 모르면 값들의 순서가 애트리뷰트들의 순서에 대응

#### 3) 릴레이션 상태
- 동적인 것
- 실제로 값이 들어간 상태, 튜플들의 집합
- 릴레이션 인스턴스, 릴레이션 어커런스 라고도 부름
- 연산에 의해 상태가 변함 - 삽입 / 삭제 / 수정
- r(R)로 표시 : r은 릴레이션상태, R은 릴레이션 스키마

#### 4) 릴레이션 스키마
- 정적인것
- 릴레이션의이름(애트리뷰트1, 애트리뷰트2, 애트리뷰트3, ...)으로 표현

#### 5) 관계형 데이터베이스의 스키마
- 데이터베이스 스키마 전체의 이름과 그 데이터베이스 내의 릴레이션 스키마들의 이름
- Company = {Employee, Department, DeptLocations, Project, WorksOn, Dependent}

#### 6) 도메인
- 유효한 값들의 집합
- 애트리뷰트 A에 대응하는 도메인 dom(A)
- 더 이상 분해되지 않는 값들의 집합
- 특정의 데이터타입이나 포맷으로 지정(전화번호면 ddd-dddd, 주민등록번호면 yymmdd-sddddsc, 날짜면 표기법에 따라 다양하게)
- 애트리뷰트 이름은 같은 도메인을 가지는 서로 다른 애트리뷰트라도 의미를 명확하게 해줌(청구일 애트리뷰트와 지불일 애트리뷰트)

#### 7) 튜플
- 튜플은 순서에 의한 값들의 모임
- 구성되는 값은 대응하는 도메인 중의 하나의 값
- t = <"홍길동", 15, "개발팀", 5> 이런식이면 4개의 값으로 구성된 4-tuple
- 이 튜플이 해당 릴레이션의 실제 한 엔터티인 것
- 릴레이션은 이런 튜플들의 집합인것

#### 8) 릴레이션의 제약조건
아래 4번주제 제약조건에서 자세히 설명함
- 도메인 제약
- 키 제약
- 엔터티 무결성 제약
- 참조 무결성 제약
- 함수적 종속 제약
- 기타 제약조건

#### 9) 변경연산자의 제약(INSERT/DELETE/UPDATE시 주의할 것)
- 변경시 제약조건을 위반해서는 안됨
- 여러 변경이 그룹으로 함께 적용되기도 함
- 변경연산으로 인해 다른 수정이 야기될수 있음
	- 무결성 제약조건을 유지하기 위해 다른 변경이 생기게 될수도 있다거나 참조되고있는 기본키가 변경되면 외래키가 변경될수도 있음

- Insert
	- 도메인, 키, 엔터티무결성, 참조무결성 4가지 제약조건 위반 가능

- Delete
	- 참조무결성 위반 가능
	- RESTRICT(연산 거절), CASCADE(참조하는 모든 튜플 연쇄적으로 삭제), SET NULL(참조하는 외래키를 NULL로 설정) 조취를 취할 수 있음

- Update
	- 도메인, 키, 엔터티무결성, 참조무결성 4가지 제약조건 위반 가능
	- 삭제 후 삽입연산과 동일하므로 해당 상황에서 발생하는 제약조건 위반 가능


## 3. 관계형 Database만드는 과정
1) 사용자가 원하는 것을 파악
2) ERD 그리기
3) 관계형 모델로 사상하기
4) 정규화
5) DDL로 스키마, 테이블 등 만들고, DML로 데이터 채워넣기

### 3-1. 사용자가 원하는 것을 파악
1) 향후 데이터베이스 사용자와 인터뷰 및 업무처리 파악
2) 데이터 요구 조건(데이터 타입)을 파악하여 문서화
3) 응용 프로그램에서 업무처리에 필요한 기능들의 요구조건 명시
4) 데이터베이스에 적용할 연산자 명시
5) 데이터베이스에 대한 개념적 스키마 설계

### 3-2) ERD 그리기
#### - ERD의 예시
![[Pasted image 20231129152341.png]]

#### 1) ER 모델의 개념  
- 엔터티와 릴레이션쉽  
- 엔터티에는 애트리뷰트, 릴레이션쉽에는 참여와 카디널리티  
  
#### 2) 애트리뷰트 타입
##### - 단순과 복합
![[Pasted image 20231129152603.png]]
- 단순 애트리뷰트는 그냥 하나의 애트리뷰트
- 복합 애트리뷰트를 예로 들면 주소에서 도, 시, 동, 도로명주소 등으로 분해되는 것

##### - 단일값과 다중값
![[Pasted image 20231129152715.png]]
- 애트리뷰트는 일반적으로 하나의 값을 가지지만, 여러 값을 가질 경우도 있음
- 단일값은 일반적인 하나의 애트리뷰트
- 다중값은 타원을 이중선으로 표시하며 대학학위가 복수전공이라거나, 색깔이 믹스컬러이거나  
- () : 애트리뷰트들이 쉼표로 구분되어 하나로 그룹화  
- {} : 다중값  
- 한 주소에 전화기가 여렇이라면  
	{AddressPhone({Phone}, Address)}이고  
	Phone(AreaCode, PhoneNumber)이며  
	Address(StreetAddress(Number, Street, AptmentNumber), City, State, Zip) 이런 식으로 표기  

##### - 저장과 유도
![[Pasted image 20231129152947.png]]
- 저장값은 일반적으로 저장된 값  
- 유도된 애트리뷰트란 저장되어 있는 값을 이용해서 알아낼 수 있는 것이며 점선 타원으로 표시  
- 예를 들어 생년월일이 저장되어 있으면 나이를 알 수 있는 것  
- 한 부서의 사원의 수도 유도될 수 있음

##### - 키 애트리뷰트
![[Pasted image 20231129153140.png]]
- ERD 그릴때는 키 애트리뷰트에는 밑줄 표시
- 애트리뷰트 값이 엔터티 집합에서 유일성/식별성을 가져서 각 엔터티를 유일하게 식별  
- 여러개가 모여서 키를 형성하면 해당 복합애트리뷰트에 밑줄, 여러 애트리뷰트가 다 키로 쓰인다면 각 애트리뷰트 밑줄

>[!note] 도메인
>애트리뷰트가 가질 수 있는 특정 값들의 집합
>예를들어 나이가 16세에서 70세까지만 가능하다면 16~70이 도메인인 것
>구현으로는 integer, float, boolean, 