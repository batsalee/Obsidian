# Heap

## 1. 개념
- 자료구조 Heap

- 힙(Heap)은 완전 이진트리 형태이다.
![[Pasted image 20231130152029.png|300x200]]
- 완전 이진트리란 마지막 레벨을 제외한 모든 레벨이 완전히 채워져 있으면서, 마지막 레벨의 모든 노드들이 왼쪽부터 채워져 있는 트리를 의미  
- 즉, 트리의 원소를 왼쪽에서 오른쪽으로 하나씩 빠짐없이 채워간 형태  

- 값들 중 최대값 혹은 최소값을 루트노드에 위치시키는 방식이다.  
- 그러므로 여러 값 중에서 최댓값이나 최솟값을 빠르게 찾을 때 사용하기 좋다.
>[!note] 우선순위큐를 힙으로 구현한다.
>최대값 혹은 최소값을 찾기 좋은 자료구조이므로

>[!warning] 
>동적으로 할당(malloc/new)된 메모리가 위치하는곳도 Heap이라고 하지만 둘은 전혀 다른 것이니 주의


## 2. Heap의 종류

최대힙(Max Heap)과 최소힙(Min Heap)이 있다

1) 최대힙
- 부모 노드가 자식 노드보다 크거나 같다.
- root에 최대값이 위치하게 된다.

2) 최소힙
- 부모 노드가 자식 노드보다 작거나 같다.
- root에 최소값이 위치하게 된다.


## 3. Heap의 특징

Heap은 완전이진트리 형태를 가지는데 완전 이진트리는 array를 사용해서 구현한다.  
그러므로 heap도 array를 사용해서 구현한다.

index 0은 root노드를 의미하며  
i번째 노드의 부모노드는 `(i - 1) / 2`번째 노드가 되고  
i번째 노드의 자식노드는 `i * 2 + 1`번째 노드와 `i * 2 + 2`번째 노드가 된다.  


## 4. Heap의 작동방식

값의 조회는 root노드(index 0)만 확인하면 최대값/최소값을 얻을 수 있으므로 O(1)으로 쉽게 가능  
반면 push나 pop의 경우 정렬을 해줘야하므로 O(logN)의 시간이 걸림  

#### 1) push 작동방식

![[Pasted image 20231130153143.png|300x300]]
위의 최소힙에 4를 push한다면?

![[Pasted image 20231130153214.png|300x300]]
먼저 트리의 가장 끝부부분에 원소를 추가한다.  
그 후 Heap의 규칙에 맞게 위치를 재설정한다.  
여기선 최소힙이므로 4가 부모노드인 6보다 작으므로 서로 위치를 바꾼다.  

![[Pasted image 20231130153325.png|300x300]]
그 다음에도 4의 부모노드와 값을 비교해서 4가 더 작다면 둘의 위치를 바꾼다.  
부모노드가 더 작다면 멈춘다.  
결과에서 볼 수 있듯이 모든 노드의 값들이 완벽히 정렬되어있는것이 아니라 느슨한 정렬상태이다.  
그러므로 root 노드만이 유의미한 값이라고 할 수 있다.  

#### 2) pop 작동방식

![[Pasted image 20231130153529.png|300x300]]
Heap에서는 pop()을 하게 되면 root의 값이 제거가 된다.  
그 후 마지막 index의 노드가 root노드로 옮겨진다.  
![[Pasted image 20231130153604.png|300x300]]
여기서부터 Heap의 조건에 맞게 위치를 정렬해주면 된다.  
최소힙이므로 root노드의 6과 자식노드들인 3, 4와 비교해서 두 자식노드 중 더 작은 값과 swap한다.  
![[Pasted image 20231130153714.png|300x300]]
또 6과 아래쪽의 자식노드들과 비교해서 더 작은값이 있는지 확인하고 있다면 swap한다.  
![[Pasted image 20231130153756.png|300x300]]
더이상 작은 자식노드가 없거나 리프노드까지 왔다면 정렬완료

>[!note] push와 pop의 차이
>push는 가장 밑에 추가해서 올라가는 방식이었다면  
>pop은 가장 위에서부터 아래로 비교해가면서 내려간다는 차이가 있음


## 5. Heap의 시간복잡도

- 원소의 추가/제거 : O(logN)
- 조회 : O(1)          // root값만 확인하는 방식이므로



※ 참고문헌
[https://doorrock.tistory.com/13](https://doorrock.tistory.com/13)