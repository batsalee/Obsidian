# 상태 다이어그램(Statechart Diagram)

## 1. 상태 다이어그램이란?

활동 다이어그램(Activity Diagram)과 굉장히 유사하기 때문에 잘 구분해야 한다.  

객체나 구성요소의 **상태에 대해 다루며**, 조건/기능에 따른 상태 변화에 대해 표현하는 다이어그램  
동적인 측면을 시각화할때 사용하며 시스템이 주고받는 이벤트를 순서대로 표현할 수 있다.  


## 2. 구성 요소

- 시작점
- 마침점
- 상태
- 전이(Transition)

#### 1) 시작점
그래프를 시작하는 지점을 나타내는 요소  
아래처럼 꽉 차있는 원으로 그리며 테두리는 검은색이어도 상관없음  
![100x100](https://blog.kakaocdn.net/dn/b0RGki/btsIzcbQfMz/rznBQBYXcYkZFg0t938N51/img.png)

#### 2) 마침점
그래프를 끝내는 지점을 나타내는 요소  
조금 비어있는 원으로 그리며 테두리는 검은색이어도 상관없음  
![100x100](https://blog.kakaocdn.net/dn/bwPkKe/btsIywIVyUs/AJwTGz37Kvrk6decz7FQM1/img.png)

#### 3) 상태
상태를 나타내는 요소  
모서리를 직각이 아닌 둥근 형태의 사각형으로 그림  

예를들어 "문 열림", "문 닫힘"같은 상태가 들어감  
주의할점은 상태가 들어가야하는것이므로 "문 열기", "문 닫기"같은 행동이 들어가선 안됨  

상태는 그냥 상태만 작성할 수도 있지만 entry, do, exit의 동작이 포함될 수도 있음  
- entry :  해당 state에 들어올 경우 하는 행동
- do :  해당 state를 유지하고 있을 때 하는 행동
- exit :  해당 state에서 벗어날 때 하는 행동
![200x80](https://blog.kakaocdn.net/dn/bHZxfD/btsIxhFWHPG/OJKfXYIfpq8B0MkJxfFk50/img.png)

![](https://blog.kakaocdn.net/dn/bEmAlp/btsIyZ4WCO5/kn4OzNhDkdCpAIb9dj8DgK/img.png)
위의 상태의 경우 해당 상태로 입장시 a3행동을 하며, 해당 상태를 유지한 동안은 a4행동을, 나갈땐 a5행동을 한 후 나간다라는 의미가 됨  

![](https://blog.kakaocdn.net/dn/3SHzv/btsIy5X9JTG/iuVfAXaBWL3m24pHFQVO51/img.png)
보통 do가 끝나면 특별한 트리거가드가 없는 한 다음상태로 전이하게 됨  

#### 4) 전이
상태의 변화를 표현할때 사용  
한방향을 가리키는 화살표로 사용하며, 하나의 화살표에 양쪽으로 가리킬 수 없음  
상태를 오가는 경우라면 화살표를 2개 사용해서 가리키게 작성해야 함  

전이는 집단의 규칙에따라 다양한 방법으로 작성될 수 있는데  
`<<행동>>` 형태로 행동만 표시하기도 하고, `행동[조건]`의 형태로 표시하기도 하고,
`트리거[가드] / 액티비티`의 형태로 표시하기도 함, 가드조건에 맞으면 트리거가 발동되어 액티비티를 한다하는 의미  

![](https://blog.kakaocdn.net/dn/et9VQ3/btsIy2ty3ZH/Oekf4ZdLhjDXl0hmb01UIk/img.png)

![](https://blog.kakaocdn.net/dn/IIPH3/btsIzylrjtd/RmXOaGxAViAxkl1IAVtB11/img.png)
첫번째 화살표는 그냥 문열기 동작을 하면 상태가 바뀐다는 뜻이 되고  
두번째 화살표의 경우 조건이 맞다면 문열기 행동을 하고, 문열기를 하고나면 상태가 바뀐다는 뜻이며  
세번째 화살표의 경우 `x <= 2` 조건(가드)이 맞으면 event(트리거)가 발생해서 `x = x * 2` 행동(액티비티)을 하고나서 상태가 바뀐다는 뜻이 된다.


## 3. 사용 예시

#### 예시 1)
![500x70](https://blog.kakaocdn.net/dn/ln2kO/btsIy2f2nBo/zoLTYvk5cjgfRZtDShmVWK/img.png)
위의 상태 다이어그램은 프로그램 시작시 Source 상태에 놓인다는 뜻이며  
guard라는 조건이 맞으면 이벤트가 발생해서 action을 수행한 후 Target상태가 된다는 뜻이다.  
그 후 Target 상태에서 나가게 되면 프로그램이 종료된다.  

#### 예시2)
![500x250](https://blog.kakaocdn.net/dn/bqNmow/btsIy3zf5t0/voRs30UniqK0xGipC14wI1/img.png)
위의 상태 다이어그램은 프로그램 시작시 s1상태에 놓인다는 뜻이며  
e1이벤트가 발생한다면 a1행동을 한 후 stateA로 진입하고  
혹은 e2 이벤트가 발생한다면 a2행동을 한 후 stateA로 진입하게 된다.  

stateA에 진입하면 entry행동으로 a3를 수행한 후 s2상태에 놓인다.  
그 후 `s2 -> s3`상태를 거치며 do인 a4행동을 하며, 나갈땐 exit인 a5행동을 한 후 stateA에서 벗어나며, stateA에서 벗어나면 프로그램이 종료된다.  

#### 예시3)
![500x130](https://blog.kakaocdn.net/dn/o6LQC/btsIyxgMhlE/6O6rzIi5OpbeytBMoAtB4K/img.png)
위의 상태 다이어그램은 프로그램 시작시 S1상태로 들어가며 entry에 의해 x = 1로 설정된다.  
그 후 x <= 2 조건에 맞으므로 이벤트가 발생해서 exit행동인 x++을 해서 x = 2가 된 후 S1상태에서 벗어나며  
이벤트 행동인 x = x * 2에 의해 x = 4가 된 후 S2에 진입한다.  
S2에 진입할때 entry에 의해 x += 5하게되고 x=9상태가 된다.  






※ 참고 문헌  
[https://ko-de-dev-green.tistory.com/96](https://ko-de-dev-green.tistory.com/96)
[https://bloodstrawberry.tistory.com/1410](https://bloodstrawberry.tistory.com/1410)
[https://www.youtube.com/watch?v=1Vinu58-RgY](https://www.youtube.com/watch?v=1Vinu58-RgY)